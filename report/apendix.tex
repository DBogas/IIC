\documentclass[12pt]{article}
\title{Apendix for STCP network study report}
\author{Diogo Bogas}
\date{12 December 2016}

\begin{document}
\maketitle

\section{Data Structures}

In this particular section, all the data structures used while crunching the data together will be described by chronological order.
the first piece of information retrieved from the STCP website, was about the lines, so the structure BusLine follows:
\begin{itemize}
\item sentido
\item accessibility
\item code
\item description
\item pubcode
\item LineStops
\end{itemize}
Sentido is an integer that can take the values 0 or 1 and represents the direction a bus goes through a line. For example, the 207 line can go from Campanhã to Mercado da Foz, and from Mercado da Foz to Campanhã.\\
Accessibility is an integer that dictates the what special access conditions a bus line has. It can have wheel chair access, baby stroler access for example. Its a variable that was born when the information was beeing gathered, but ended up remaining in the structure.\\
Code is the server way to tell bus lines from each other.\\
Description is a String that tells us what appears in front of a bus that if going through a line.\\
PubCode is the people's way to tell lines from one another.\\
And lineStops is a List of Strings that represents the Stops that compose a line.\\

After knowing each line's composing Stops, a list of all the stops was constructed, and the info for each stop was stored locally. The JAVA structure to represent a Stop is:

\begin{enumerate}
	\item stopCode, the ID of a Stop.
	\item address.
	\item zone, the part of the city a Stop belongs to.
	\item name, the way people know which stop is which.
	\item longitude.
	\item latitude.
	\item totalLinesServed, a number.
	\item linesServed, a list of the lines served.
	\item adjacentStops, the stops it can connect to.
	\item distanceBFS, an auxiliary variable to a BFS method.
\end{enumerate}
\newpage
	The last four variables are derived, and are used as auxiliary variables to some methods. In a graph, a Stop is a node. The edges are the interactions between nodes:
	
\begin{enumerate}
	\item source;
	\item target;
	\item desc;
	\item weight;
\end{enumerate}

Source and Target define the edge, as the network is a directed graph. Desc is a String composed by both stopCodes, source + - + target.
The weight variable represents the number of lines that use that edge. 


When grouping the information by street, the nodes of the graph(streets themselves) were represented by the BusStreet structure:

\begin{itemize}
	\item street
	\item stops, a list of all the stops in that street
	\item  neighbours
	\item longitude;
	\item latitude;
\end{itemize}

	The neighbours attribute was supposed to represent the streets adjacent to a particular street, but ended up not beeing used. The edges in this type of grouping are reresented by AdressEdge:
	
	\begin{itemize}
	\item src
	\item dest
	\item weight
	\item nome
	\end{itemize}
	
	The graph is directed still, weight is the number of lines that use that particular interaction and nome is a way to diferentiate the edges, and is derived from the source and target streets.
	
	The final way to group the stops is by code, so the Spot edge was created:
	
	\begin{itemize}
	\item code
	\item stops
	\item LinesServed
	\end{itemize}
	
Code is the way to tell Spots apart, and it's derivarion is described in the main document.\\
Stops is a list of stops the Spot has in itself.\\
LinesServed is a list with all the lines that go through that Spot.\\

The edges in this type of grouping are represented by the SpotEdge structure:
\begin{itemize}
\item from
\item to
\item weight
\item name
\end{itemize}

From and to are the source and target Spots, weight and name, as the other types of edges are the number of lines that use the edge and a way to distinguish the edges respectively.

\section{Gephi source files}

The first file to be described is called stops.csv , and it represents every single stop there is in this network. Five columns per stop :
	
	\begin{itemize}
		\item Id , is the code of each stop (the unique attribute).
		\item Address
		\item Zone
		\item name
		\item latitude
		\item longitude
	\end{itemize}
	
	To make this file, the method makeNodesCSV was created.
	It begins by printing "Id;Address;Zone;Name;Longitude;Latitude" in the first line of the output file. Then, for each stop it reads from the allStops.txt file, prints its attributes by the order sugested in the first line. As in the source file, each stop only takes one line.
	
	The second file to talk about is called allEdges.csv, with four columns per edge:
	
	\begin{itemize}
		\item Source stop
		\item Target stop
		\item type which is going to be directed for every edge in this study
		\item weight 
	\end{itemize}
	
	The generating method to this file is allEdgesCSV, and is similar to the nodes one.
	It also begins by printing what each column represents, (in this case "Source;Target;Type;Weight") and then for each edge it receives, prints its attributes in the order required. The source of the edges comes from another method.\\
	The method makeAllLinesCSV was built with the intent of beeing able to make the .csv files for the edges of all bus lines. This idea was abandoned, but the method was repurposed. Besides making those files, it also returns an hashmap with all the edges it has seen, beeing the source of this second file.\\
	Because the stops were also grouped by address, we need two more files for that, the node file for that grouping is called streetNodes, and the edges file is called streetEdges. The first is generated by the makeStreetNodesCSV method, which in the first line of the file writes "Id;TotalStops;Longitude;Latitude", and in each subsequent line writes each streetNode's values. The second file for this type of grouping  is generated by makeStreetEdgesCSV, and this file holds, for each edge, the weight, source, target and type.The weight in this particular case represents how many bus lines use that particular edge.\\
	The code grouping has a very similar file generation and type of information stored. SpotNodes and SpotEdges are the nodes and edges files, generated by makeSpotNodeCSV and makeSpotEdgesCSV respectively. The nodes files holds the Id and the number of total stops grouped by that code, while the edges file, for each edge, knows the source, the target, the weight and the type.
	Now that all the important files and methods have been exposed, we can rely on the previously mentioned Gephi to study the network.\\

This ends this appendix.

\end{document}